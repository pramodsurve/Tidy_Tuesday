---
title: "R Notebook"
output: html_notebook
---

Week 20 - Broadband data. First load the data. 

```{r data}
library(tidytuesdayR)
library(tidyverse)

tuesdaydata <- tidytuesdayR::tt_load('2021-05-11')

broadband <- tuesdaydata$broadband

broadband_zip <- tuesdaydata$broadband_zip

```

Explore and clean data

```{r Explore}

library(DataExplorer)

#Clean Broadband data

broadband <- broadband %>% janitor::clean_names()

#glimpse(broadband)

fact_cols <- c('st')

dbl_cols <- c('broadband_availability_per_fcc', 'broadband_usage')

char_Cols <- c('county_id')

broadband <- broadband %>% 
  mutate(across(.cols = all_of(fact_cols), .fns = as_factor),
         across(.cols = all_of(dbl_cols), .fns = as.double),
         across(.cols = all_of(char_Cols), .fns = as.character))

#introduce(broadband)

broadband <- broadband %>% drop_na(broadband_usage)


#Clean broadband_zip data

#glimpse(broadband_zip)

broadband_zip <- broadband_zip %>% janitor::clean_names()

char_Cols <- c('county_id', 'postal_code')
fact_cols <- c('st')

broadband_zip <- broadband_zip %>% 
  mutate(across(.cols = all_of(char_Cols), .fns = as.character),
         across(.cols = all_of(fact_cols), .fns = as_factor))

```
Build following type of graphs.

Broadband dataset- broadband usage

1. Box Plot by state
2. Ridge Plot by state
3. Timehorizon type chart by state
3. Chloropeth map by county

How do I credit tidytuesday


Broadband Zip dataset- broadband usage

1. Box Plot by state
2. Ridge Plot by state
3. Timehorizon type chart by state
3. Chloropeth map by zip code



Let us build a box plot by state.

```{r Box_Plot}

bu_county <- broadband %>% ggplot(aes(broadband_usage, reorder(st, broadband_usage, median))) + geom_boxplot() +
  labs(title = "Broadband usage by state", 
       y = "State",
       x = "Broadband Usage",
       subtitle = "Based on County Data",
       caption = "#TidyTuesday \n Week 20 Broadband Usage Data")

bu_zip <- broadband_zip %>% ggplot(aes(broadband_usage, reorder(st, broadband_usage, median))) + geom_boxplot() +
  labs(title = "Broadband usage by state", 
       y = "State",
       x = "Broadband Usage",
       subtitle = "Based on Zip Data",
       caption = "#TidyTuesday \n Week 20 Broadband Usage Data")

library(patchwork)

broad_band_box <- bu_county + bu_zip

broad_band_box

ggsave(here::here("Week 20 - Broadband", "Output", "BroadBandUsageBoxPlot.png"), width = 10.5, height = 8, units = "in")

```
Ridge Plot

```{r Ridge Plot}

library(ggridges)

  bb_ridge_county <- broadband %>% ggplot(aes(broadband_usage, reorder(st, broadband_usage, median))) + geom_density_ridges() +
  xlim(c(0,1)) +
  labs(title = "Broadband usage by state", 
       y = "State",
       x = "Broadband Usage",
       subtitle = "Based on County Data",
       caption = "#TidyTuesday \n Week 20 Broadband Usage Data") 

bb_ridge_zip <- broadband_zip %>% ggplot(aes(broadband_usage, reorder(st, broadband_usage, median))) + geom_density_ridges() +
  xlim(c(0,1)) +
  labs(title = "Broadband usage by state", 
       y = "State",
       x = "Broadband Usage",
       subtitle = "Based on Zip Data",
       caption = "#TidyTuesday \n Week 20 Broadband Usage Data") 

bb_ridge_county + bb_ridge_zip

ggsave(here::here("Week 20 - Broadband", "Output", "BroadBandUsageRidgePlot.png"), width = 10.5, height = 8, units = "in")

```

Time Horizon Chart

```{r Time Horizon Chart}



```



When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
